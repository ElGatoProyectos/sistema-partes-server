// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum ERole_BD {
  SUPERADMIN
  ADMIN
  USER
}

model User {
  id       Int    @id @default(autoincrement())
  email    String @unique
  dni      String @unique
  name     String @db.Text()
  lastname String @db.Text()
  phone    String @db.Text()

  role   ERole_BD
  status Boolean  @default(true)

  password   String
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}

enum E_Proyecto_Estado {
  ACTIVO
  INACTIVO
  PENDIENTE
  FINALIZADO
}

model Proyecto {
  id               Int                @id @default(autoincrement())
  titulo           String             @db.Text()
  descripcion      String?            @db.Text()
  estado           E_Proyecto_Estado
  fecha_creacion   DateTime           @db.Date()
  // Unnamed: 5 parece ser un campo que no tiene relevancia o es temporal, así que no se incluye en el modelo
  UnidadProduccion UnidadProduccion[]
}

model UnidadProduccion {
  id          Int     @id @default(autoincrement())
  proyecto_id Int
  codigo      Int
  titulo      String  @db.Text()
  nota        String? @db.Text()

  Proyecto Proyecto @relation(fields: [proyecto_id], references: [id])
}

model Tren {
  id        Int     @id @default(autoincrement())
  codigo    Int
  titulo    String  @db.Text()
  cuadrilla String? @db.Text()
  nota      String? @db.Text()
  operario  Int
  oficial   Int
  peon      Int

  ReporteTrenes ReporteTrenes[]
}

model Partida {
  id        Int    @id @default(autoincrement())
  idInterno Int
  item      String @db.Text()
  partida   String @db.Text()
  unidad    String @db.Text()
  metrado   Float
  precio    Float
  parcial   Float?

  ReportePartidas ReportePartidas[]
}

model ListaPrecio {
  id          Int      @id @default(autoincrement())
  fechaInicio DateTime
  fechaFin    DateTime
  titulo      String
}

model DetallePrecioHoraMO {
  id           Int    @id @default(autoincrement())
  codigo       Int
  categoria    String @db.Text()
  horaNormal   Float
  horaExtra60  Float
  horaExtra100 Float
}

model ReporteTrenes {
  id            Int      @id @default(autoincrement())
  trenId        Int // Relación con Tren
  costoTotal    Float
  costoAnterior Float
  costoActual   Float
  costoParcial  Float
  saldo         Float?
  lunes         Float?
  martes        Float?
  miercoles     Float?
  jueves        Float?
  viernes       Float?
  sabado        Float?
  domingo       Float?
  fechaInicio   DateTime
  fechaFin      DateTime
  Tren          Tren     @relation(fields: [trenId], references: [id])
}

model ReportePartidas {
  id            Int     @id @default(autoincrement())
  partidaId     Int // Relación con Partida
  costoTotal    Float
  costoAnterior Float
  costoActual   Float
  costoParcial  Float
  Partida       Partida @relation(fields: [partidaId], references: [id])
}
